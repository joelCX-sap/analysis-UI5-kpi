<div class="chart-container">
  <ui5-title level="H2">ğŸ“Š Purchase KPI Dashboard</ui5-title>
  <ui5-label style="margin-top: 0.5rem; color: #666;">Interactive purchase KPI dashboard with real-time data from SAP HANA</ui5-label>

  <ui5-button id="btn-clear" design="Emphasized" style="margin-top: 1rem;" hidden>Clear Filter</ui5-button>

  <!-- Delivery Status -->
  <ui5-panel header-text="ğŸšš Delivery Status (ELIKZ)" style="margin-top: 1.5rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸšš Delivery Status (ELIKZ)</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="delivery_completion">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartDelivery"></canvas>
    </div>
  </ui5-panel>

  <!-- Plant Performance -->
  <ui5-panel header-text="ğŸ­ Requested vs Delivered by Plant (WERKS)" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ­ Requested vs Delivered by Plant (WERKS)</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="plant_performance">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartPlant"></canvas>
    </div>
  </ui5-panel>

  <!-- Delivery Time Trends -->
  <ui5-panel header-text="â±ï¸ Average Delivery Time by Month" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>â±ï¸ Average Delivery Time by Month</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="delivery_time_trends">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartMonth"></canvas>
    </div>
  </ui5-panel>

  <!-- On-Time Delivery -->
  <ui5-panel header-text="ğŸ¯ On-Time vs Late Deliveries" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ¯ On-Time vs Late Deliveries</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="on_time_delivery">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartOnTime"></canvas>
    </div>
  </ui5-panel>

  <!-- Lead Time Analysis -->
  <ui5-panel header-text="ğŸ“ˆ Lead Time Analysis (Planned vs Actual)" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ“ˆ Lead Time Analysis (Planned vs Actual)</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="lead_time_analysis">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartLeadTime"></canvas>
    </div>
  </ui5-panel>

  <!-- Material Fill Rate -->
  <ui5-panel header-text="ğŸ“¦ Fill Rate by Material (Top 10 Lowest)" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ“¦ Fill Rate by Material (Top 10 Lowest)</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="material_fill_rate">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartFillRate"></canvas>
    </div>
  </ui5-panel>

  <!-- Status Distribution -->
  <ui5-panel header-text="ğŸ“‹ Document Status Distribution" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ“‹ Document Status Distribution</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="status_distribution">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartStatus"></canvas>
    </div>
  </ui5-panel>

  <!-- Category Distribution -->
  <ui5-panel header-text="ğŸ“Š Document Category Distribution" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ“Š Document Category Distribution</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="category_distribution">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartCategory"></canvas>
    </div>
  </ui5-panel>

  <!-- Movement Types -->
  <ui5-panel header-text="ğŸ”„ Inventory Movement Types" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ”„ Inventory Movement Types</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="movement_types">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartMovement"></canvas>
    </div>
  </ui5-panel>

  <!-- UOM Distribution -->
  <ui5-panel header-text="âš–ï¸ Unit of Measure Distribution" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>âš–ï¸ Unit of Measure Distribution</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="uom_distribution">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartUOM"></canvas>
    </div>
  </ui5-panel>

  <!-- Open Orders Aging -->
  <ui5-panel header-text="â³ Open Orders Aging" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>â³ Open Orders Aging</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="open_orders_aging">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartAging"></canvas>
    </div>
  </ui5-panel>

  <!-- Document Types -->
  <ui5-panel header-text="ğŸ“„ Purchase Document Types" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ“„ Purchase Document Types</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="document_types">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartDocTypes"></canvas>
    </div>
  </ui5-panel>

  <!-- Material Analysis -->
  <ui5-panel header-text="ğŸ”§ Material Analysis (Top 10 by Volume)" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ”§ Material Analysis (Top 10 by Volume)</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="material_analysis">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartMaterials"></canvas>
    </div>
  </ui5-panel>

  <!-- Deletion Stats -->
  <ui5-panel header-text="ğŸ—‘ï¸ Deletion Statistics" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸ—‘ï¸ Deletion Statistics</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="deletion_stats">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartDeletion"></canvas>
    </div>
  </ui5-panel>

  <!-- Freshness Analysis -->
  <ui5-panel header-text="ğŸŒ± Freshness Analysis (Manufacturing to Delivery)" style="margin-top: 1rem;">
    <div slot="header" style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <span>ğŸŒ± Freshness Analysis (Manufacturing to Delivery)</span>
      <ui5-button design="Transparent" class="analyze-btn" data-kpi="freshness_analysis">ğŸ” Analyze</ui5-button>
    </div>
    <div class="chart-container" style="position: relative; height: 350px; padding: 1rem;">
      <canvas id="chartFreshness"></canvas>
    </div>
  </ui5-panel>

  <ui5-panel header-text="ğŸ’¡ Instructions" style="margin-top: 1rem;">
    <div style="padding: 1rem; line-height: 1.6;">
      <ui5-label><strong>Interactivity:</strong></ui5-label>
      <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
        <li>Click on any bar or segment to filter all charts</li>
        <li>Use the "Clear Filter" button to return to full view</li>
        <li>Use the "ğŸ” Analyze" button on each chart to get AI analysis</li>
        <li>Data is loaded in real-time from SAP HANA</li>
      </ul>
      
      <ui5-label style="margin-top: 1rem;"><strong>Available KPIs:</strong></ui5-label>
      <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
        <li><strong>Delivery Status:</strong> Completed vs Pending</li>
        <li><strong>Plant Performance:</strong> Requested vs delivered quantities</li>
        <li><strong>Time Trends:</strong> Average delivery time by month</li>
        <li><strong>On-Time Delivery:</strong> Punctual vs late deliveries</li>
        <li><strong>Lead Time:</strong> Planned vs actual comparison</li>
        <li><strong>Fill Rate:</strong> Fulfillment percentage by material</li>
        <li><strong>Status & Categories:</strong> Document distribution</li>
        <li><strong>Movements & Inventory:</strong> Types and units of measure</li>
        <li><strong>Open Orders:</strong> Aging by day ranges</li>
        <li><strong>Material Analysis:</strong> Top materials by volume</li>
        <li><strong>Freshness:</strong> Time from manufacturing to delivery</li>
      </ul>
    </div>
  </ui5-panel>

  <!-- KPI Analysis Modal -->
  <div id="kpiAnalysisModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">ğŸ” KPI Analysis</h3>
        <button class="modal-close" id="closeModal">&times;</button>
      </div>
      <div class="modal-body">
        <div id="modalLoading" class="modal-loading">
          <div class="loading-spinner"></div>
          <p>Analyzing data with AI...</p>
          <small>Connecting to SAP HANA and processing with LLM</small>
        </div>
        <div id="modalContent" class="modal-analysis" style="display: none;">
          <!-- Analysis content will be loaded here -->
        </div>
      </div>
      <div class="modal-footer">
        <ui5-button id="closeModalBtn" design="Emphasized">Close</ui5-button>
      </div>
    </div>
  </div>
</div>
